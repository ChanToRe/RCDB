{% extends 'base.html' %}
{% load md_filter %}
{% block content %}
<style>
    #title {
        margin: 2% 1% 0% 5%;
    }

    #export-buttons {
        margin: 0% 0% 1% 5%
    }

    #notice {
        margin : 1% 1% 2% 5%
    }

    #notice {
        margin:0% 5% 2% 5%
    }

    #Handsontable {
        margin:0% 0% 5% 5%
    }
</style>

<body>
    <div id="title">
            <h1>RCDB</h1>
    </div>

    <div id="export-buttons" class="visible">
        <button id="export-csv" class="btn size-medium bg-blue text-black shadow hover-moveup">
            Export csv file
        </button>
    </div> 

    <div id="notice">
        *시료의 무게가 미기재일 경우 Weight_g는 0으로 표기됩니다.<br>
        *시료의 종류가 미기재일 경우 Material은 NULL로 표기됩니다.<br>
        *LabID가 미기재일 경우 LabID는 NULL로 표기됩니다.
    </div>
        
    <div id="Handsontable">      
        <script>
            let getList = [];
            let rabelList = ['id', 'Name','State','City', 'Site', 'Material', 'Weight_g', 'Laboratory', 'LabID', 'Age_BP', 'Error', 'Report' ];
            var rcdbs = JSON.parse("{{rcdbsJson|escapejs}}");
            for (let i =0; i<rcdbs.length;i++){
                getList.push([
                rcdbs[i].id, 
                rcdbs[i].Name,
                rcdbs[i].State,
                rcdbs[i].City,
                rcdbs[i].Site,
                rcdbs[i].Material,
                rcdbs[i].Weight_g,
                rcdbs[i].Laboratory,
                rcdbs[i].LabID,
                rcdbs[i].Age_BP,
                rcdbs[i].Error,
                rcdbs[i].Report
                ])
            };

            var container = document.getElementById('Handsontable');
            document.getElementById("Handsontable").style.fontSize = '10pt';
            var hot = new Handsontable(container, {
              data: getList,
              rowHeaders: true,
              colHeaders: true,
              filters: true,
              dropdownMenu: true,
              licenseKey: 'non-commercial-and-evaluation',
              colHeaders: rabelList

            });
            document.getElementById("export-csv").addEventListener("click", function(event) { 
                hot.getPlugin("exportFile").downloadFile("csv", {filename: "rcdb", columnHeaders: true});
                
                })
        </script>
    </div>
</body>
{% endblock %}
